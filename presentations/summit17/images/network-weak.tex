\tikzset{>=stealth', pil/.style={ ->, color=black!60, thick, } }
\begin{tikzpicture}
\begin{semilogxaxis}[
    height=0.7\textwidth,
    width=\textwidth,
    xmin=1,xmax=16384,
    ymin=3.0,ymax=4.5,
    ytick={3, 3.5, 4, 4.5},
    yticklabels={3, 3.5, 4, },
    %axis y discontinuity=crunch,
    xtick={1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384},
    xticklabels={1, , 4, , 16, , 64, , 256, , 1024, , 4096, , 16384, },
    ylabel=\footnotesize time (s),
    xlabel=\footnotesize nodes,
    xticklabel style={yshift=-2pt},
    yticklabel style={xshift=-2pt},
    xlabel style={yshift=7pt},
    ylabel style={yshift=-20pt},
    line width=1.2pt,
    legend style = {at={(1,0)}, anchor=south east},
    grid=major]

    \addplot[color=red, mark=o,mark size=2, only marks, very thick]
        table[x=nodes,y=mpi]
        {images/network-weak.tbl};
    \addplot[color=blue, mark=o,mark size=1, very thick]
        table[x=nodes,y=dry]
        {images/network-weak.tbl};
    \legend{\footnotesize MPI, \footnotesize dry run};

    \node[above, fill=blue!15, align=center, inner sep=1mm]
       (n1) at (axis cs:4,3.25){\scriptsize 21.6k cells};
    \path[pil,->] (n1.north) edge (axis cs:1.1,3.75);

    \node[above, fill=blue!15, align=center, inner sep=1mm]
       (n64) at (axis cs:64,3.5){\scriptsize 1.3M cells};
    \path[pil,->] (n64.north) edge (axis cs:64,4.1);

    \node[above, fill=blue!15, align=center, inner sep=1mm]
       (n16k) at (axis cs:4096,3.6){\scriptsize 353M cells};
    \path[pil,->] (n16k.north) edge (axis cs:15500,4.17);
\end{semilogxaxis}

\end{tikzpicture}
